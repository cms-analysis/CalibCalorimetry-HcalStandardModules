process PROD = {

// Loads the events from testbeam files
	source = HcalTBSource { 
//		untracked vstring fileNames = { '/uscms_data/d1/jmmans/tutorial_data/HTB_011609.root' }
//		untracked vstring fileNames = { '/localscratch/f/fedor/HTBqc_007804.root' }
		untracked vstring fileNames = { '/uscms_data/d1/szleper/ped_hb-/HTBqc_007804.root' }
		untracked int32 maxEvents = 1000
                untracked vstring streams = { 'HCAL_DCC020:20','HCAL_Trigger','HCAL_SlowData','HCAL_TDC:5' }
	}

	module unpacker = HcalRawToDigi {
                int32 firstSample = 6
                int32 lastSample = 15
                untracked int32 HcalFirstFED = 20
                untracked vint32 FEDs = { 20 }
		bool FilterDataQuality = false
		bool FilterAmplitude = false
		int32 FilterAmpBegin = 4
		int32 FilterAmpEnd = 7
		double FilterAmpLevel = 22.0
	}

	module analysis = HcalPedestalAnalyzer {
               untracked string outputPedestalsDest = 'means_hb-_2.txt'
               untracked string outputPedestalWidthsDest = 'widths_hb-_2.txt'
               untracked string outputFileHist = 'peds_hb-_2.root'
               untracked int32 nevtsample = 9999999
               untracked int32 hiSaveflag = 1
               untracked int32 pedValflag = 0
	}
        es_module = HcalDbProducer {untracked string dbSource = "hardcode"}
        //es_module dbprod = HcalDbProducer {}	
	path p = { unpacker,  analysis }



// stuff for the calibration system

  es_module dbprod = HcalDbProducer {}
  es_prefer = HcalDbProducer {}

  es_source es_hardcode = HcalHardcodeCalibrations {untracked vstring toGet = {"Pedestals", "PedestalWidths", "Gains", "GainWidths", "QIEShape", "QIEData", "ChannelQuality"}}

  es_source es_ascii = HcalTextCalibrations { VPSet input = {
//    {string object = "ElectronicsMap" string file ='/localscratch/f/fedor/hb-_wedge2_pedled.map'}
    {string object = "ElectronicsMap" FileInPath file ='/uscms/home/szleper/work/maps/hb-_wedge2_pedled.map'}
//    {string object = "ElectronicsMap" string file ='/uscms_data/d1/jmmans/tutorial_data/maps/hbho_ring12_tb04.txt'}
   }  
  }

}

