process LED = {

        #use for 15x and up
        untracked PSet maxEvents = {untracked int32 input = 1000}

	source = HcalTBSource { 
		untracked vstring fileNames = { 'file:USC_000311.root' }
		#use for earlier releases of CMSSW
                #untracked int32 maxEvents = 1000
                untracked vstring streams = { 'HCAL_Trigger',
                    'HCAL_DCC700','HCAL_DCC701','HCAL_DCC702','HCAL_DCC703',
                    'HCAL_DCC704','HCAL_DCC705','HCAL_DCC706','HCAL_DCC707',
                    'HCAL_DCC708','HCAL_DCC709','HCAL_DCC710','HCAL_DCC711',
                    'HCAL_DCC712','HCAL_DCC713','HCAL_DCC714','HCAL_DCC715',
                    'HCAL_DCC716','HCAL_DCC717','HCAL_DCC718','HCAL_DCC719',
                    'HCAL_DCC720','HCAL_DCC721','HCAL_DCC722','HCAL_DCC723',
                    'HCAL_DCC724','HCAL_DCC725','HCAL_DCC726','HCAL_DCC727',
                    'HCAL_DCC728','HCAL_DCC729','HCAL_DCC730','HCAL_DCC731' 
                }
	}


	module unpacker = HcalRawToDigi {
                int32 firstSample = 0
                int32 lastSample = 9
                untracked bool UnpackCalib = true
                bool FilterDataQuality = true
                untracked bool ComplainEmptyData = false
                #untracked vint32 FEDs = {}
                InputTag InputLabel = source
	}


	module analysis = HcalLedAnalyzer {
                untracked string inputPedestalsSource = 'dummy.txt'
                untracked string outputFileHist = '311_new.root'
                untracked string outputFileText = '311_new.txt'
                untracked int32 nevtsample = 100000
                untracked int32 analysisflag = 2
                untracked int32 hiSaveflag = 1
                untracked bool usecalib = true
	}


	path p = { unpacker,  analysis }

// stuff for the calibration (you may want to use more appropriate sources, i.e. not the hardcoded values)

   es_module = HcalDbProducer {}

   es_source es_hardcode = HcalHardcodeCalibrations {untracked vstring toGet = {"Pedestals", "PedestalWidths", "Gains", "GainWidths", "QIEShape", "QIEData", "ChannelQuality"}}


   es_source es_ascii = HcalTextCalibrations { VPSet input = {
     {
       string object = "ElectronicsMap"
       FileInPath file="emap_15x.txt"
     }
   }  
   }

}


